![](/ga_cog.png)

# Deploying your group project 

Deploying as a group is _slightly_ different than deploying an individual project when trying to set up your database. This markdown will help you get through that

**Lesson Objectives** 

- Deploy React
- Set up a shared Atlas database 
- Setting up to deploy to Heroku

---

## Deploying Create React App

This should work:

```
heroku create
git push heroku master
heroku open
```
If not, use either:

- https://stackabuse.com/how-to-deploy-a-react-app-to-heroku/
- https://www.netlify.com/blog/2016/07/22/deploy-react-apps-in-less-than-30-seconds/

## Setting up a shared Atlas database 

Remember when we originally set up our databases, we all used our own individual Atlas Mongo Databases. That's fine for individual projects, but for group projects we of course want to just be adding/getting/deleting/etc. onto _one_ database. Luuckily, MongoDB Atlas allows for collaborated databases, so let's go ahead and set that up. 

Choose **one person** to create the database on their Atlas account. Everyone else in the group will be given different usernames and passwords to connect to it. 

### For that one person in the group

- [Log into](https://cloud.mongodb.com/user?nds=true#/atlas/login) the same Atlas account you made before and go to the same cluster you made before
- On the clusters page, on the sidebar under the SECURITY section, click on `Database Access` 
![](https://imgur.com/NWXFMUB.png)
- Once you click that, it should take you to the following page. Click on the `+ ADD NEW USER` button on the top right of the table
![](https://imgur.com/Fr1xpR4.png)
- **Add a new user for each additional person in your group**
![](https://i.imgur.com/4eO6Zr5.png)
    - For the username: put your group partner's name 
    - For the password: autogenerate a secure password, and **make sure to give this to the group partner.** They'll need it in a bit!
    - For the user privileges: select `Read and write to any database` 
- Once you've added all your group partners, go back to your cluster by clicking on the `Clusters` link in the sidebar under the ATLAS header. 
- It might take some time for Atlas to deploy your changes after adding users, so wait until that's done (you'll know it's done when the blue notification saying it's applying your changes disappears)
- Once that's done and you're on the Clusters page, click on the `CONNECT` button 
![](https://imgur.com/Jv2sBDH.png)
- That should open up a modal. Choose the `Connect Your Application` method, and then copy the Connection String 
![](https://imgur.com/p7zoaN2.png)
- Give the connection string to everyone in the group 

### For everyone in the group 

- make sure `.env` files are being ignored with `.gitignore` 
- because you are ignoring the file everyone will have to `touch .env` on their own machines - make sure it's on the same level as your `package.json` 
- don't forget to install [dotenv](https://www.npmjs.com/package/dotenv) and configure it in your `server.js` file
- **ADD the following** to your `.env` file (remember no spaces, no semi-colons, no quotes)
```
MONGODB_URI=<insert your group's connection string here>
```
- Make sure you each replace the `<username>` and `<password>` where asked! The person who created the database should have given everyone their username and autogenerated passwords. 
- Once you're done, save it and try `console.log(process.env)` to make sure you can access your variables on your machine
- When you set up your server, you should all now be able to connect to the same database. 
    
## Setting up for Heroku Deployment 

This section is still the exact same as the [previous Heroku Deployment notes](https://git.generalassemb.ly/Software-Engineering-Immersive-Remote/SEIR-Belcher/blob/master/projects/project_2/2.%20HEROKU.md) **except for things dealing with the databse**. Additionally, similar to your paired homework assignment, the frontend and backend need _one_ GitHub repo and _one_ Heroku deployment _**EACH**_. Make sure you know who is in charge of creating which repos and who is in charge of deploying which part. The person (or people) who is in charge of creating a repo should share GitHub access with the other group members, and the person (or people) responsible for deploying should share Heroku app access with the other group members.

#### Follow the previous heroku deployment notes to properly set up a server and create an app on Heroku, except for...

1. In the `Set Environmental Variables` section
   
    - **In server.js:** m MONGODB_URI 
    
    ```js
    const MONGODB_URI  = process.env.MONGODB_URI 
    ```
    
    ```js
    // Connect to Mongo
    mongoose.connect(MONGODB_URI, () => {
        console.log('whatever')
    })

    // Error / success
    db.on('error', (err) => console.log(err.message + ' is Mongod not running?'));
    db.on('connected', () => console.log('mongo connected: ', MONGODB_URI));
    db.on('disconnected', () => console.log('mongo disconnected'));
    ```
1. In the `Add Database from MongoDB Atlas` section
    - For the Config Var VALUE, just put one person's connection string with their username and password 
    
1. Everything else you should be able to follow as normal! 
